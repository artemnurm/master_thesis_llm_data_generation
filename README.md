# Методы генерации синтетических данных с использованием больших языковых моделей для задачи классификации входящей корреспонденции по каталогу медицинских услуг

## Описание проекта

Данный проект представляет чистую реализацию исследования по автоматической бинарной классификации гарантийных писем страховых компаний для определения типа запроса медицинских услуг:

- **Класс 0**: Общие запросы без конкретных кодов медицинских услуг
- **Класс 1**: Письма с конкретными кодами медицинских услуг (формат F##.##.##.#.###)

## Основные компоненты

### 1. Обработка данных
- Загрузка и анализ исходных данных (162 обучающих примера)
- Обработка дисбаланса классов (соотношение 2.7:1)
- Анализ качества разметки данных

### 2. Генерация синтетических данных
- Шаблонный подход для генерации писем класса 0
- Гибридный генеративный подход для класса 1 с использованием LLM
- Валидация качества синтетических данных

### 3. Классификация
- Логистическая регрессия на эмбеддингах Sentence Transformers
- Случайный лес для сравнения
- Комбинированный подход: семантические эмбеддинги + рукотворные признаки

### 4. Эксперименты
- Базовый эксперимент без синтетических данных
- Эксперимент с синтетической аугментацией
- Ablation study для определения оптимального размера синтетических данных
- Статистическая валидация результатов

## Структура проекта

```
thesis_clean_repo/
├── README.md
├── requirements.txt
├── main.py                     # Главный скрипт для запуска экспериментов
├── config.yaml                 # Конфигурация экспериментов
├── data/
│   ├── raw/                    # Исходные данные
│   └── processed/              # Обработанные данные
├── src/
│   ├── data/
│   │   ├── data_loader.py
│   │   └── data_analyzer.py
│   ├── generation/
│   │   ├── template_generator.py
│   │   └── llm_generator.py
│   ├── models/
│   │   └── classifier.py
│   ├── experiments/
│   │   └── experiment_runner.py
│   └── utils/
│       ├── metrics.py
│       └── visualization.py
├── results/
│   ├── experiments/
│   └── reports/
└── notebooks/
    └── analysis.ipynb
```

## Ключевые результаты

Согласно проведенным экспериментам:

- **Базовая модель (только реальные данные)**: F1-score ~0.75-0.80
- **Модель с синтетическими данными**: F1-score ~0.83-0.88 (+8-13%)
- **Оптимальное соотношение** реальных к синтетическим данным: ~1:1
- **Точность распознавания**: 88-89% (требования промышленного применения)

## Установка и запуск

```bash
# Установка зависимостей
pip install -r requirements.txt

# Запуск основного эксперимента
python main.py

# Запуск ablation study
python main.py --mode ablation

# Генерация отчета
python main.py --mode report
```

## Научная новизна

1. **Гибридный подход** к генерации синтетических данных, интегрирующий шаблонные методы с LLM
2. **Экспериментальная валидация** современных LLM с технологией Structured Output
3. **Комбинированная архитектура** классификации (семантические эмбеддинги + доменные признаки)
4. **Многоуровневая система валидации** качества синтетических данных

## Контакты

Автор: Нурмухаметов Артем Начибович  
Направление: 45.04.03 Фундаментальная и прикладная лингвистика  
Университет: НИ ТГУ, 2025